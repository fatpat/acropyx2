(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[824],{1659:function(e,t,n){"use strict";var r=n(5318);t.Z=void 0;var s=r(n(4938)),i=n(5893),c=(0,s.default)((0,i.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore");t.Z=c},7958:function(e,t,n){"use strict";var r=n(5318);t.Z=void 0;var s=r(n(4938)),i=n(5893),c=(0,s.default)((0,i.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");t.Z=c},5846:function(e,t,n){"use strict";var r=n(5318);t.Z=void 0;var s=r(n(4938)),i=n(5893),c=(0,s.default)((0,i.jsx)("path",{d:"M12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-3.48.94C8.04 17.55 7 16.76 7 14H5c0 2.7.93 4.41 2.3 5.5.5.4 1.1.7 1.7.9V24h6v-3.6c.6-.2 1.2-.5 1.7-.9 1.37-1.09 2.3-2.8 2.3-5.5h-2c0 2.76-1.04 3.55-1.52 3.94C14.68 18.54 14 19 12 19s-2.68-.46-3.48-1.06zM12 0C5.92 0 1 1.9 1 4.25v3.49c0 .81.88 1.26 1.56.83.14-.09.28-.18.44-.26L5 13h2l1.5-6.28c1.1-.14 2.28-.22 3.5-.22s2.4.08 3.5.22L17 13h2l2-4.69c.16.09.3.17.44.26.68.43 1.56-.02 1.56-.83V4.25C23 1.9 18.08 0 12 0zM5.88 11.24 4.37 7.69c.75-.28 1.6-.52 2.53-.71l-1.02 4.26zm12.24 0L17.1 6.98c.93.19 1.78.43 2.53.71l-1.51 3.55z"}),"Paragliding");t.Z=c},454:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/competitions/run",function(){return n(6736)}])},6736:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ne}});var r=n(8520),s=n.n(r),i=n(5893),c=n(7294),a=n(1163),o=n(4713),u=n(6886),l=n(5861),d=n(3321),p=n(666),f=n(1458),x=n(7357),h=n(6242),v=n(122),m=n(298),j=n(5050),Z=n(5670),y=n(1496),g=n(44),b=n(1395),w=n(1300),k=n(594),P=n(7440),C=n(3911),_=n(984),T=n(4229),S=n(5089),I=n(2563),E=n(5846),R=(n(4803),n(4117)),N=(n(7497),n(9780),n(5148)),A=n(9233),O=(n(1194),n(3521),n(7250),n(3740),n(4451)),z=n(3798),X=n(8321),L=n(4906),H=n(4267);function J(e,t,n,r,s,i,c){try{var a=e[i](c),o=a.value}catch(u){return void n(u)}a.done?t(o):Promise.resolve(o).then(r,s)}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,s=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(o){s=!0,i=o}finally{try{r||null==a.return||a.return()}finally{if(s)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var M=function(e){var t,n=e.code,r=e.rid,a=B((0,N.z)(),4),o=(a[0],a[1],a[2],a[3]),d=(0,c.useState)(!1),p=d[0],f=d[1],x=(t=s().mark((function e(){var t,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=B,e.next=3,(0,A.Xv)("/competitions/".concat(n,"/results/").concat(r),{expect_json:!0});case 3:if(e.t1=e.sent,t=(0,e.t0)(e.t1,3),i=t[0],c=t[1],t[2],!i){e.next=12;break}return o("error while retrieving results for competition ".concat(n,": ").concat(i)),f(!1),e.abrupt("return");case 12:c.results=c.results.map((function(e,t){return e.rank=t+1,e})),f(c);case 14:case"end":return e.stop()}}),e)})),function(){var e=this,n=arguments;return new Promise((function(r,s){var i=t.apply(e,n);function c(e){J(i,r,s,c,a,"next",e)}function a(e){J(i,r,s,c,a,"throw",e)}c(void 0)}))});return(0,c.useEffect)((function(){x()}),[]),p?(0,i.jsxs)(H.Z,{children:[(0,i.jsxs)(l.Z,{varian:"h2",children:[p.final?"Final":"Intermediate"," results"]}),(0,i.jsx)(u.ZP,{container:!0,spacing:7,children:(0,i.jsx)(u.ZP,{item:!0,xs:12,sm:12,children:(0,i.jsx)(R.Z,{rows:p.results,headCells:[{id:"rank"},{id:"pilot",rewrite:function(e){return e.name}},{id:"score",numeric:!0}],orderById:"rank"})})})]}):"loading ..."},F=n(1736),D=n(3946),V=n(7958),W=n(1659);function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,s=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(o){s=!0,i=o}finally{try{r||null==a.return||a.return()}finally{if(s)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var G,K=function(e){e.comp;var t=e.run,n=(e.rid,q((0,N.z)(),4)),r=(n[0],n[1],n[2],n[3],(0,c.useState)(0)),s=r[0],a=r[1],o=(0,c.useState)(null),d=o[0],p=o[1],f=function(){(s-=1)<0&&(s=t.pilots.length-1),p(t.pilots[s]),a(s)};return(0,c.useEffect)((function(){s=t.pilots.length-1,p(t.pilots[s]),a(s)}),[]),(0,i.jsxs)(H.Z,{children:[d&&(0,i.jsx)(u.ZP,{container:!0,spacing:7,direction:"column",alignItems:"center",justifyContent:"center",children:(0,i.jsx)(u.ZP,{item:!0,xs:12,sm:12,children:(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(D.Z,{onClick:f,children:(0,i.jsx)(W.Z,{})}),d.name,(0,i.jsx)(D.Z,{onClick:f,children:(0,i.jsx)(V.Z,{})})]})})}),(0,i.jsx)(u.ZP,{container:!0,spacing:7,children:(0,i.jsx)(u.ZP,{item:!0,xs:12,sm:12,children:(0,i.jsx)(R.Z,{rows:t.flights,headCells:[{id:"rank"},{id:"pilot",rewrite:function(e){return e.name}},{id:"score",numeric:!0}],orderById:"rank"})})})]})};function Q(e,t,n,r,s,i,c){try{var a=e[i](c),o=a.value}catch(u){return void n(u)}a.done?t(o):Promise.resolve(o).then(r,s)}function U(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var i=e.apply(t,n);function c(e){Q(i,r,s,c,a,"next",e)}function a(e){Q(i,r,s,c,a,"throw",e)}c(void 0)}))}}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,s=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(o){s=!0,i=o}finally{try{r||null==a.return||a.return()}finally{if(s)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ee=(0,y.ZP)(g.Z)((function(e){var t=e.theme;return Y(G={},t.breakpoints.down("md"),{minWidth:100}),Y(G,t.breakpoints.down("sm"),{minWidth:67}),G})),te=(0,y.ZP)("span")((function(e){var t=e.theme;return Y({lineHeight:1.71,fontSize:"0.875rem",marginLeft:t.spacing(2.4)},t.breakpoints.down("md"),{display:"none"})})),ne=function(){var e=(0,a.useRouter)(),t=e.query,n=t.cid,r=t.rid,y=$((0,N.z)(),4),g=y[0],R=(y[1],y[2],y[3]),H=(0,o.aF)(),J=(H.user,H.authError,H.authIisLoading,(0,c.useState)(!1)),B=J[0],D=J[1],V=(0,c.useState)(!1),W=V[0],q=V[1],G=(0,c.useState)({}),Q=G[0],Y=G[1],ne=(0,c.useState)(!1),re=ne[0],se=ne[1],ie=(0,c.useState)("actions"),ce=ie[0],ae=ie[1],oe=$((0,A.Rs)(),1)[0],ue=((0,c.useRef)(),(0,c.useRef)(),(0,c.useRef)(),(0,c.useRef)(),(0,c.useRef)(),U(s().mark((function e(){var t,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return se(!0),e.t0=$,e.next=4,(0,A.Xv)("/competitions/".concat(n),{expect_json:!0});case 4:if(e.t1=e.sent,t=(0,e.t0)(e.t1,3),i=t[0],c=t[1],t[2],!i){e.next=15;break}return D(!1),q(!1),Y(!1),R("Error while retrieving competitions list: ".concat(i)),e.abrupt("return");case 15:c.delete="delete",c.update="update",c.id=c._id,D(c),q(c.runs[r]),Y(Object.assign({},c)),se(!1);case 22:case"end":return e.stop()}}),e)})))),le=U(s().mark((function e(t){var i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(confirm("Are you sure to ".concat(t," run ").concat(r," of competition ").concat(n," ?"))){e.next=2;break}return e.abrupt("return");case 2:return e.t0=$,e.next=5,(0,A.Xv)("/competitions/".concat(n,"/runs/").concat(r,"/").concat(t),{expected_status:204,method:"POST"});case 5:if(e.t1=e.sent,i=(0,e.t0)(e.t1,3),c=i[0],i[1],i[2],!c){e.next=13;break}return R("error while ".concat(t," run ").concat(r," of competition ").concat(n,": ").concat(c)),e.abrupt("return");case 13:ue();case 14:case"end":return e.stop()}}),e)}))),de=U(s().mark((function e(t){var i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=$,e.next=3,(0,A.Xv)("/competitions/".concat(n,"/runs/").concat(r,"/pilots"),{expected_status:204,method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.map((function(e){return e.civlid})))});case 3:if(e.t1=e.sent,i=(0,e.t0)(e.t1,3),c=i[0],i[1],i[2],!c){e.next=11;break}return R("error while updating pilots list ".concat(n,": ").concat(c)),e.abrupt("return");case 11:ue();case 12:case"end":return e.stop()}}),e)}))),pe=U(s().mark((function e(t){var i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=$,e.next=3,(0,A.Xv)("/competitions/".concat(n,"/runs/").concat(r,"/teams"),{expected_status:204,method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.map((function(e){return e.id})))});case 3:if(e.t1=e.sent,i=(0,e.t0)(e.t1,3),c=i[0],i[1],i[2],!c){e.next=11;break}return R("error while updating teams list ".concat(n,": ").concat(c)),e.abrupt("return");case 11:ue();case 12:case"end":return e.stop()}}),e)}))),fe=U(s().mark((function e(t){var i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=$,e.next=3,(0,A.Xv)("/competitions/".concat(n,"/runs/").concat(r,"/judges"),{expected_status:204,method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.map((function(e){return e.id})))});case 3:if(e.t1=e.sent,i=(0,e.t0)(e.t1,3),c=i[0],i[1],i[2],!c){e.next=11;break}return R("error while updating judges list ".concat(n,": ").concat(c)),e.abrupt("return");case 11:ue();case 12:case"end":return e.stop()}}),e)}))),xe=U(s().mark((function e(t){var i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=$,e.next=3,(0,A.Xv)("/competitions/".concat(n,"/runs/").concat(r,"/repeatable_tricks"),{expected_status:204,method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.map((function(e){return e.id})))});case 3:if(e.t1=e.sent,i=(0,e.t0)(e.t1,3),c=i[0],i[1],i[2],!c){e.next=11;break}return R("error while updating repeatable tricks list ".concat(n,": ").concat(c)),e.abrupt("return");case 11:ue();case 12:case"end":return e.stop()}}),e)}))),he=U(s().mark((function e(t){var i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=$,e.next=3,(0,A.Xv)("/competitions/".concat(n,"/runs/").concat(r,"/config"),{expected_status:204,method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 3:if(e.t1=e.sent,i=(0,e.t0)(e.t1,3),c=i[0],i[1],i[2],!c){e.next=11;break}return R("error while updating config ".concat(n,": ").concat(c)),e.abrupt("return");case 11:ue();case 12:case"end":return e.stop()}}),e)})));U(s().mark((function e(t){var i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("No yet implemented! #TODO"),e.abrupt("return");case 5:return se(!0),e.t0=$,e.next=9,(0,A.Xv)("/competitions/".concat(undefined,"/runs/").concat(r),{method:"DELETE",expected_status:204});case 9:e.t1=e.sent,i=(0,e.t0)(e.t1,3),c=i[0],i[1],i[2],c?R("Error while deleting run #".concat(r," from competition ").concat(n,": ").concat(c)):g("Run #".concat(r," from competition ").concat(n," successfully deleted")),ue();case 16:case"end":return e.stop()}}),e)})));return(0,c.useEffect)((function(){e.isReady&&ue()}),[e.isReady]),re||!e.isReady?(0,i.jsxs)(x.Z,{sx:{width:"100%",textAlign:"center"},children:[(0,i.jsx)(f.Z,{}),"Loading"]}):B&&W?(0,i.jsxs)(u.ZP,{container:!0,spacing:6,children:[(0,i.jsxs)(u.ZP,{item:!0,xs:12,children:[(0,i.jsx)(l.Z,{variant:"h6",children:(0,i.jsx)(v.Z,{href:"/competitions/show?cid=".concat(B.code),children:B.name})}),(0,i.jsxs)(l.Z,{variant:"h3",children:["Run #",r,(0,i.jsx)(p.Z,{onClick:ue})]})]}),(0,i.jsxs)(u.ZP,{item:!0,xs:12,md:6,sx:{paddingBottom:4},children:[(0,i.jsxs)(l.Z,{children:["Status: ",(0,i.jsx)("strong",{children:W.state}),"init"==W.state&&(0,i.jsx)(d.Z,{variant:"outlined",startIcon:(0,i.jsx)(w.Z,{}),onClick:function(){return le("open")},children:"Open"}),"open"==W.state&&(0,i.jsx)(d.Z,{variant:"outlined",startIcon:(0,i.jsx)(k.Z,{}),onClick:function(){return le("close")},children:"Close"}),"closed"==W.state&&(0,i.jsx)(d.Z,{variant:"outlined",startIcon:(0,i.jsx)(P.Z,{}),onClick:function(){return le("reopen")},children:"Reopen"})]}),(0,i.jsxs)(l.Z,{children:["Type: ",(0,i.jsx)("strong",{children:Q.type})]})]}),(0,i.jsx)(u.ZP,{item:!0,xs:12,children:(0,i.jsx)(h.Z,{children:(0,i.jsxs)(Z.ZP,{value:ce,children:[(0,i.jsxs)(m.Z,{onChange:function(e,t){ae(t)},"aria-label":"account-settings tabs",sx:{borderBottom:function(e){return"1px solid ".concat(e.palette.divider)}},children:["solo"==B.type&&(0,i.jsx)(ee,{value:"pilots",label:(0,i.jsxs)(x.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(b.Z,{}),(0,i.jsx)(te,{children:"Pilots"})]})}),"synchro"==B.type&&(0,i.jsx)(ee,{value:"teams",label:(0,i.jsxs)(x.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(I.Z,{}),(0,i.jsx)(te,{children:"Teams"})]})}),(0,i.jsx)(ee,{value:"judges",label:(0,i.jsxs)(x.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(C.Z,{}),(0,i.jsx)(te,{children:"Judges"})]})}),(0,i.jsx)(ee,{value:"repeatable_tricks",label:(0,i.jsxs)(x.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(_.Z,{}),(0,i.jsx)(te,{children:"Repeatables tricks"})]})}),(0,i.jsx)(ee,{value:"settings",label:(0,i.jsxs)(x.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(T.Z,{}),(0,i.jsx)(te,{children:"Run Settings"})]})}),(0,i.jsx)(ee,{value:"flights",label:(0,i.jsxs)(x.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(E.Z,{}),(0,i.jsx)(te,{children:"Flights"})]})}),(0,i.jsx)(ee,{value:"results",label:(0,i.jsxs)(x.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(S.Z,{}),(0,i.jsx)(te,{children:"Results"})]})})]}),(0,i.jsx)(j.Z,{sx:{p:0},value:"pilots",children:(0,i.jsx)(z.Z,{pilots:W.pilots,allPilots:B.pilots,update:function(e){return de(e)}})}),(0,i.jsx)(j.Z,{sx:{p:0},value:"teams",children:(0,i.jsx)(O.Z,{teams:W.teams,allTeams:B.teams,update:function(e){return pe(e)}})}),(0,i.jsx)(j.Z,{sx:{p:0},value:"judges",children:(0,i.jsx)(X.Z,{judges:W.judges,allJudges:B.judges,update:function(e){return fe(e)}})}),(0,i.jsx)(j.Z,{sx:{p:0},value:"repeatable_tricks",children:(0,i.jsx)(F.Z,{tricks:W.repeatable_tricks,allTricks:oe,update:function(e){return xe(e)}})}),(0,i.jsx)(j.Z,{sx:{p:0},value:"settings",children:(0,i.jsx)(L.Z,{config:W.config,update:function(e){return he(e)},type:B.type})}),(0,i.jsx)(j.Z,{sx:{p:0},value:"flights",children:(0,i.jsx)(K,{comp:B,run:W,rid:r})}),(0,i.jsx)(j.Z,{sx:{p:0},value:"results",children:(0,i.jsx)(M,{code:n,rid:r})})]})})})]}):""}}},function(e){e.O(0,[885,808,698,109,725,404,738,335,595,774,888,179],(function(){return t=454,e(e.s=t);var t}));var t=e.O();_N_E=t}]);