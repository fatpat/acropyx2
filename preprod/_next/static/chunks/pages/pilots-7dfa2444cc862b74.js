(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[927],{3555:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pilots",function(){return e(6388)}])},6388:function(t,n,e){"use strict";e.r(n);var r=e(8520),i=e.n(r),a=e(5893),c=e(7294),s=(e(1163),e(4713)),o=e(9072),u=e(9630),l=e(5084),d=e(1849),p=e(7971),f=e(6070),x=e(1953),h=e(7497),v=e(5148),m=e(9233);function g(t,n,e,r,i,a,c){try{var s=t[a](c),o=s.value}catch(u){return void e(u)}s.done?n(o):Promise.resolve(o).then(r,i)}function j(t){return function(){var n=this,e=arguments;return new Promise((function(r,i){var a=t.apply(n,e);function c(t){g(a,r,i,c,s,"next",t)}function s(t){g(a,r,i,c,s,"throw",t)}c(void 0)}))}}function b(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=[],r=!0,i=!1,a=void 0;try{for(var c,s=t[Symbol.iterator]();!(r=(c=s.next()).done)&&(e.push(c.value),!n||e.length!==n);r=!0);}catch(o){i=!0,a=o}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return e}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.default=(0,s.tl)((function(){var t=b((0,v.z)(),4),n=t[0],e=(t[1],t[2],t[3]),r=(0,s.aF)(),g=(r.user,r.authError,r.authIisLoading,(0,c.useState)([])),k=g[0],Z=g[1],w=(0,c.useState)([]),y=w[0],P=w[1],_=(0,c.useState)(!1),C=_[0],E=_[1],I=j(i().mark((function t(){var n,r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E("Loading pilots list"),t.t0=b,t.next=4,(0,m.Xv)("/pilots/",{expect_json:!0});case 4:if(t.t1=t.sent,n=(0,t.t0)(t.t1,3),r=n[0],a=n[1],n[2],!r){t.next=14;break}return Z(!1),P(!1),e("Error while retrieving pilots list: ".concat(r)),t.abrupt("return");case 14:Z(a),P(a),E(!1);case 17:case"end":return t.stop()}}),t)}))),N=function(t){event.preventDefault(),S(parseInt(document.getElementById("civlid").value))},S=j(i().mark((function t(r){var a,c,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r<1||isNaN(r))){t.next=2;break}return t.abrupt("return");case 2:return E("Updating pilot #".concat(r)),t.t0=b,t.next=6,(0,m.Xv)("/pilots/".concat(r),{method:"POST",expected_status:201});case 6:if(t.t1=t.sent,a=(0,t.t0)(t.t1,3),c=a[0],s=a[1],a[2],!c){t.next=13;break}return t.abrupt("return",e("Error updating Pilot #".concat(r,": ").concat(c)));case 13:n("Pilot #".concat(r," successfully updated")),Z(k.map((function(t){return t.civlid==r?s:t}))),P(y.map((function(t){return t.civlid==r?s:t}))),E(null);case 17:case"end":return t.stop()}}),t)}))),A=j(i().mark((function t(r){var a,c,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r<1||isNaN(r))){t.next=2;break}return t.abrupt("return");case 2:return E("Chaging gender of pilot #".concat(r)),t.t0=b,t.next=6,(0,m.Xv)("/pilots/".concat(r,"/gender"),{method:"PATCH",expected_status:200});case 6:if(t.t1=t.sent,a=(0,t.t0)(t.t1,3),c=a[0],s=a[1],a[2],!c){t.next=13;break}return t.abrupt("return",e("Error changing gender of pilot #".concat(r,": ").concat(c)));case 13:Z(k.map((function(t){return t.civlid==r?s:t}))),P(y.map((function(t){return t.civlid==r?s:t}))),E(null),n("Pilot #".concat(r," gender changed to ").concat(s.gender));case 17:case"end":return t.stop()}}),t)}))),T=j(i().mark((function t(){var r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(confirm("Are you sure to update all pilots ?")){t.next=2;break}return t.abrupt("return");case 2:return E("Updating all pilots"),t.t0=b,t.next=6,(0,m.Xv)("/pilots/update_all",{method:"POST",expected_status:201});case 6:t.t1=t.sent,r=(0,t.t0)(t.t1,3),a=r[0],r[1],r[2],a?e("Error updating all pilots: ".concat(a)):n("Pilots successfully updated"),I();case 13:case"end":return t.stop()}}),t)}))),X=j(i().mark((function t(){var r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E("Updating rankings"),t.t0=b,t.next=4,(0,m.Xv)("/pilots/update_rankings",{method:"POST",expected_status:201});case 4:t.t1=t.sent,r=(0,t.t0)(t.t1,3),a=r[0],r[1],r[2],a?e("Error updating rankings: ".concat(a)):n("Rankings successfully updated"),I();case 11:case"end":return t.stop()}}),t)}))),D=j(i().mark((function t(n){var e,r,a,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.target.value,!((r=parseInt(e))>0)){t.next=5;break}return Z(y.filter((function(t){return t.civlid==r}))),t.abrupt("return");case 5:e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=new RegExp(e,"i"),c=y.filter((function(t){return t.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"").match(a)})),Z(c);case 9:case"end":return t.stop()}}),t)})));return(0,c.useEffect)((function(){I()}),[]),C?(0,a.jsxs)(x.Z,{sx:{width:"100%",textAlign:"center"},children:[(0,a.jsx)(f.Z,{}),C]}):k?(0,a.jsxs)(o.ZP,{container:!0,spacing:6,children:[(0,a.jsx)(o.ZP,{item:!0,xs:12,sx:{paddingBottom:4},children:(0,a.jsxs)(u.Z,{variant:"h5",children:["Pilots",(0,a.jsx)(d.Z,{onClick:I})]})}),(0,a.jsx)(o.ZP,{item:!0,xs:4,sm:4,children:(0,a.jsx)(p.Z,{fullWidth:!0,id:"outlined-basic",label:"Search pilot",variant:"outlined",onChange:D})}),(0,a.jsx)(o.ZP,{item:!0,xs:2,sm:2,children:(0,a.jsx)("form",{onSubmit:N,children:(0,a.jsx)(p.Z,{id:"civlid",label:"CIVL ID"})})}),(0,a.jsx)(o.ZP,{item:!0,xs:2,sm:2,children:(0,a.jsx)("form",{onSubmit:N,children:(0,a.jsx)(l.Z,{type:"submit",children:"Add or Update pilot"})})}),(0,a.jsxs)(o.ZP,{item:!0,xs:4,sm:4,container:!0,direction:"row",justifyContent:"flex-end",children:[(0,a.jsx)(l.Z,{variant:"outlined",startIcon:(0,a.jsx)(d.Z,{}),onClick:X,children:"Update rankings"}),(0,a.jsx)(l.Z,{variant:"outlined",startIcon:(0,a.jsx)(d.Z,{}),onClick:T,disabled:!0,children:"Synchronize from CIVL"})]}),k.map((function(t){return(0,a.jsx)(o.ZP,{item:!0,xs:12,sm:4,children:(0,a.jsx)(h.Z,{pilot:t,updatePilot:S,changeGender:A})},t.civlid)}))]}):(0,a.jsx)("p",{children:"No data"})}))},7497:function(t,n,e){"use strict";var r=e(5893),i=e(1953),a=e(9837),c=e(5084),s=e(8346),o=e(4731),u=e(9647),l=e(9630),d=e(1359),p=e(9318),f=e(693);n.Z=function(t){var n=t.pilot;return(0,r.jsxs)(a.Z,{sx:{position:"relative"},children:[(0,r.jsx)(u.Z,{sx:{height:"12.625rem"},image:n.background_picture}),(0,r.jsx)(o.Z,{alt:n.name,src:n.photo,sx:{width:150,height:150,left:"1.313rem",top:"4.5rem",position:"absolute",border:function(t){return"0.25rem solid ".concat(t.palette.common.white)}}}),(0,r.jsx)(d.Z,{children:(0,r.jsxs)(i.Z,{sx:{mt:5.75,mb:8.75,display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsxs)(i.Z,{sx:{mr:2,mb:1,display:"flex",flexDirection:"column"},children:[(0,r.jsxs)(l.Z,{variant:"h6",children:[(0,r.jsx)(s.Z,{href:n.link,target:"_blank",rel:"noopener noreferrer",children:n.name})," ",(0,r.jsx)("span",{onClick:function(){return t.changeGender(n.civlid)},children:"man"==n.gender?"\u2642\ufe0f":"\u2640\ufe0f"}),"\xa0",(0,r.jsx)(p.Z,{countryCode:f.convertAlphaCode(n.country),svg:!0,title:f.getCountry(n.country)})]}),(0,r.jsxs)(l.Z,{variant:"caption",children:["CIVL ID: ",n.civlid]}),(0,r.jsxs)(l.Z,{variant:"caption",children:["Rank: #",n.rank]})]}),(0,r.jsx)(c.Z,{variant:"contained",onClick:function(){return t.updatePilot(n.civlid)},children:"Update pilot"})]})})]})}}},function(t){t.O(0,[292,177,774,888,179],(function(){return n=3555,t(t.s=n);var n}));var n=t.O();_N_E=n}]);